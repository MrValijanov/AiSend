<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>AiSend Â· Demo super app</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-main: #020c06;
      --bg-card: #04160c;
      --bg-card-soft: #072011;
      --accent: #b7ff45;
      --accent-soft: #96f03b;
      --accent-strong: #d6ff7b;
      --text-main: #f9ffe8;
      --text-muted: #a5b79a;
      --danger: #ff5b5b;
      --border-soft: rgba(255,255,255,0.05);
      --radius-xl: 22px;
      --radius-full: 999px;
      --shadow-soft: 0 18px 50px rgba(0,0,0,0.65);
      --shadow-chip: 0 8px 25px rgba(0,0,0,0.6);
      --transition-fast: 0.18s ease-out;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #05240f 0%, #020907 40%, #010503 100%);
      color: var(--text-main);
      min-height: 100vh;
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 14px 14px 26px;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .header-title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .header-title span {
      font-size: 11px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .header-title h1 {
      font-size: 20px;
      font-weight: 700;
    }

    .profile-btn {
      border: none;
      outline: none;
      padding: 10px 14px;
      border-radius: var(--radius-full);
      background: rgba(10, 35, 18, 0.9);
      color: var(--text-main);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      box-shadow: var(--shadow-chip);
    }

    .profile-btn span.avatar {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: linear-gradient(135deg, #24e070, #b7ff45);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      color: #041107;
    }

    .profile-btn span.label {
      opacity: 0.9;
    }

    .card {
      background: radial-gradient(circle at top, #0e381d 0%, #06150b 55%, #041007 100%);
      border-radius: var(--radius-xl);
      padding: 16px 18px 18px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(183, 255, 69, 0.16);
      margin-bottom: 14px;
      position: relative;
      overflow: hidden;
    }

    .card-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .card-label {
      font-size: 12px;
      color: var(--text-muted);
    }

    .total-balance-value {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: 0.03em;
      margin-bottom: 6px;
    }

    .total-trend-row {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 9px;
      border-radius: var(--radius-full);
      background: rgba(0, 0, 0, 0.24);
      font-size: 11px;
      color: var(--text-muted);
    }

    .trend-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 7px;
      border-radius: var(--radius-full);
      background: rgba(18, 115, 32, 0.9);
      color: #d6ffb7;
      font-size: 11px;
    }

    .trend-pill span.dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #b7ff45;
    }

    .expand-toggle {
      border: none;
      outline: none;
      border-radius: var(--radius-full);
      padding: 6px 9px;
      background: rgba(0, 0, 0, 0.32);
      color: var(--text-muted);
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .expand-toggle span.chevron {
      display: inline-block;
      transition: transform var(--transition-fast);
    }

    .expand-toggle.expanded span.chevron {
      transform: rotate(180deg);
    }

    .assets-panel {
      margin-top: 12px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.45), rgba(3, 24, 8, 0.9));
      border: 1px solid rgba(255, 255, 255, 0.03);
      padding: 10px 10px 8px;
      display: none;
    }

    .assets-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 4px;
    }

    .assets-row + .assets-row {
      border-top: 1px dashed rgba(255, 255, 255, 0.04);
    }

    .asset-title {
      font-size: 12px;
    }

    .asset-sub {
      font-size: 11px;
      color: var(--text-muted);
    }

    .asset-amount {
      font-size: 13px;
      font-weight: 600;
    }

    .actions-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 14px;
    }

    .action-btn {
      border-radius: 18px;
      padding: 10px 4px 8px;
      border: 1px solid rgba(255,255,255,0.04);
      background: rgba(0,0,0,0.32);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .action-icon {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(11, 51, 23, 0.9);
      box-shadow: var(--shadow-chip);
      font-size: 12px;
    }

    .action-btn.active {
      border-color: rgba(183, 255, 69, 0.35);
      background: radial-gradient(circle at top, rgba(183, 255, 69, 0.16), rgba(0,0,0,0.7));
      color: var(--accent-strong);
    }

    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .section-sub {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .qt-card {
      margin-top: 14px;
      background: linear-gradient(145deg, #04140a, #030905);
      border-radius: var(--radius-xl);
      border: 1px solid var(--border-soft);
      padding: 14px 14px 16px;
      box-shadow: var(--shadow-soft);
    }

    .field-label {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .field-row {
      margin-bottom: 10px;
    }

    .select,
    .input {
      width: 100%;
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      background: rgba(0,0,0,0.45);
      padding: 10px 12px;
      color: var(--text-main);
      font-size: 13px;
      outline: none;
      appearance: none;
    }

    .select:focus,
    .input:focus {
      border-color: rgba(183, 255, 69, 0.6);
      box-shadow: 0 0 0 1px rgba(183, 255, 69, 0.4);
    }

    .quick-layout {
      display: grid;
      grid-template-columns: 1.1fr 0.8fr;
      gap: 8px;
    }

    .help-text {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .quote-box {
      margin-top: 8px;
      border-radius: 14px;
      padding: 10px 10px 9px;
      background: radial-gradient(circle at top left, rgba(183,255,69,0.15), rgba(0,0,0,0.8));
      border: 1px solid rgba(183, 255, 69, 0.22);
      font-size: 12px;
    }

    .quote-main {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 4px;
    }

    .quote-main span.label {
      color: var(--text-muted);
      font-size: 11px;
    }

    .quote-main span.value {
      font-size: 14px;
      font-weight: 600;
    }

    .fee-row {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: var(--text-muted);
    }

    .fee-row span.value {
      color: var(--accent-soft);
    }

    .btn-primary {
      margin-top: 10px;
      width: 100%;
      border-radius: var(--radius-full);
      border: none;
      padding: 12px 16px;
      background: linear-gradient(135deg, #b7ff45, #86ff2a);
      color: #042108;
      font-weight: 700;
      font-size: 14px;
      box-shadow: var(--shadow-soft);
      outline: none;
    }

    .btn-primary:active {
      transform: scale(0.98);
    }

    .status-text {
      margin-top: 8px;
      font-size: 11px;
      color: var(--text-muted);
    }

    .status-text.ok {
      color: #7dff7d;
    }

    .status-text.err {
      color: var(--danger);
    }

    .footer-note {
      margin-top: 14px;
      font-size: 10px;
      color: var(--text-muted);
      text-align: center;
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-title">
        <span>AiSend Â· Demo</span>
        <h1>Super balance</h1>
      </div>
      <button class="profile-btn" id="profileOpen">
        <span class="avatar">TG</span>
        <span class="label">Profil</span>
      </button>
    </header>
<!-- Total Balance card -->
    <section class="card" id="balanceCard">
      <div class="card-header-row">
        <div class="card-label">Umumiy balans</div>
        <button class="expand-toggle" id="assetsToggle">
          Barcha aktivlar
          <span class="chevron">â–¼</span>
        </button>
      </div>

      <div class="total-balance-value" id="totalBalanceText">
        12 450.00 USZ
      </div>

      <div class="total-trend-row">
        <div class="trend-pill">
          <span class="dot"></span>
          <span>+3.4%</span>
        </div>
        <span>Oxirgi hafta (demo)</span>
      </div>

      <div class="assets-panel" id="assetsPanel">
        <div class="assets-row">
          <div>
            <div class="asset-title">Fiat Â· UZS balansi</div>
            <div class="asset-sub">Asosiy balans</div>
          </div>
          <div class="asset-amount" id="assetFiatUzs">7 250 000 UZS</div>
        </div>
        <div class="assets-row">
          <div>
            <div class="asset-title">Fiat Â· KZT balansi</div>
            <div class="asset-sub">Chegara osha karta uchun</div>
          </div>
          <div class="asset-amount" id="assetFiatKzt">126 800 KZT</div>
        </div>
        <div class="assets-row">
          <div>
            <div class="asset-title">Crypto (demo)</div>
            <div class="asset-sub">BTC, USDT va boshqalar</div>
          </div>
          <div class="asset-amount">0.021 BTC</div>
        </div>
        <div class="assets-row">
          <div>
            <div class="asset-title">Stocks (demo)</div>
            <div class="asset-sub">AAPL, TSLA, QQQ...</div>
          </div>
          <div class="asset-amount">$2 340</div>
        </div>
      </div>

      <!-- Action buttons row -->
      <div class="actions-row">
        <button class="action-btn active" data-action="send">
          <div class="action-icon">â†—</div>
          <div>Send</div>
        </button>
        <button class="action-btn" data-action="exchange">
          <div class="action-icon">â‡„</div>
          <div>Exchange</div>
        </button>
        <button class="action-btn" data-action="crypto">
          <div class="action-icon">â‚¿</div>
          <div>Crypto</div>
        </button>
        <button class="action-btn" data-action="stocks">
          <div class="action-icon">ðŸ“ˆ</div>
          <div>Stocks</div>
        </button>
      </div>
    </section>

    <!-- Quick Transfer (Send) section -->
    <section class="qt-card">
      <div class="section-title">Quick Transfer</div>
      <div class="section-sub">
        UZS â†’ KZT / KGS kartaga tezkor oâ€˜tkazmalar (demo). Komissiya tarkibini oldindan koâ€˜rib turasiz.
      </div>

      <div class="field-row quick-layout">
        <div>
          <div class="field-label">From valyuta</div>
          <select class="select" id="qtFrom">
            <option value="UZS">UZS (Uzbekistan)</option>
            <option value="KZT">KZT (Kazakhstan)</option>
            <option value="KGS">KGS (Kyrgyzstan)</option>
          </select>
        </div>
        <div>
          <div class="field-label">To valyuta</div>
          <select class="select" id="qtTo">
            <option value="KZT">KZT (Kazakhstan)</option>
            <option value="UZS">UZS (Uzbekistan)</option>
            <option value="KGS">KGS (Kyrgyzstan)</option>
          </select>
        </div>
      </div>

      <div class="field-row">
        <div class="field-label">Miqdor</div>
        <input
          id="qtAmount"
          class="input"
          type="number"
          inputmode="decimal"
          placeholder="Miqdor kiriting, masalan 500000"
        />
      </div>

      <div class="field-row">
        <div class="field-label">Qabul qiluvchi (demo)</div>
        <input
          id="qtRecipient"
          class="input"
          type="text"
          placeholder="Telefon, karta raqami yoki @username"
        />
      </div>

      <div class="help-text">
        Komissiyalar: <strong>1% exchange</strong> + <strong>1% transfer</strong> (demo). Real ilovada bu raqamlar
        litsenziyaga qarab oâ€˜zgaradi.
      </div>

      <div class="quote-box" id="quoteBox">
        <div class="quote-main">
          <span class="label">Qabul qiluvchi oladi (taxminan)</span>
          <span class="value" id="qtResult">0 KZT</span>
        </div>
        <div class="fee-row">
          <span>Exchange fee (1%)</span>
          <span class="value" id="qtExFee">0</span>
        </div>
        <div class="fee-row">
          <span>Transfer fee (1%)</span>
          <span class="value" id="qtTrFee">0</span>
        </div>
        <div class="fee-row">
          <span>Umumiy komissiya</span>
          <span class="value" id="qtTotalFee">0</span>
        </div>
      </div>

      <button class="btn-primary" id="qtSendBtn">
        Yuborishni tasdiqlash (demo)
      </button>
      <div class="status-text" id="qtStatus">
        Miqdor va qabul qiluvchini kiriting â€“ demo hisob-kitob chiqadi.
      </div>
    </section>

    <div class="footer-note">
      AiSend demo interfeysi. Crypto, stock va real balanslar keyingi bosqichlarda
      litsenziya + KYC bilan toâ€˜liq qoâ€˜shiladi.
    </div>

    <!-- PROFILE SHEET -->
    <div id="profileBg" style="
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(18px);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 40;
    ">
      <div id="profileSheet" style="
        width: 100%;
        max-width: 480px;
        background: radial-gradient(circle at top, #062712 0%, #020805 55%, #010403 100%);
        border-radius: 22px 22px 0 0;
        border: 1px solid rgba(183,255,69,0.18);
        padding: 16px 18px 20px;
        box-shadow: 0 -18px 40px rgba(0,0,0,0.8);
      ">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
          <div style="font-weight:600;">Telegram profil</div>
          <button id="profileClose" style="
            border:none;
            background:rgba(0,0,0,0.4);
            color:var(--text-muted);
            border-radius:999px;
            width:26px;
            height:26px;
          ">âœ•</button>
        </div>
        <div style="font-size:13px;line-height:1.7;margin-bottom:10px;">
          <div>Ism: <span id="pf_name">-</span></div>
          <div>ID: <span id="pf_id">-</span></div>
          <div>Username: <span id="pf_username">-</span></div>
        </div>
        <div style="margin-top:10px;font-size:11px;color:var(--text-muted);">
          Maâ€™lumotlar faqat demo uchun ishlatiladi, serverga yuborilmaydi.
        </div>
      </div>
    </div>
</div> <!-- /container -->

  <script>
    // ===== Demo data for balances (just UI, no real money) =====
    const DEMO_BALANCES = {
      total: "12 450.00 USZ",
      fiatUzs: "7 250 000 UZS",
      fiatKzt: "126 800 KZT",
    };

    document.getElementById("totalBalanceText").textContent = DEMO_BALANCES.total;
    document.getElementById("assetFiatUzs").textContent = DEMO_BALANCES.fiatUzs;
    document.getElementById("assetFiatKzt").textContent = DEMO_BALANCES.fiatKzt;

    // ===== Expand / collapse assets panel =====
    const assetsToggle = document.getElementById("assetsToggle");
    const assetsPanel = document.getElementById("assetsPanel");

    assetsToggle.addEventListener("click", () => {
      const isOpen = assetsPanel.style.display === "block";
      assetsPanel.style.display = isOpen ? "none" : "block";
      assetsToggle.classList.toggle("expanded", !isOpen);
    });

    // ===== Action buttons (Send / Exchange / Crypto / Stocks) =====
    document.querySelectorAll(".action-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        document
          .querySelectorAll(".action-btn")
          .forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        const action = btn.dataset.action;
        if (action !== "send") {
          alert(action + " bo'limi tez orada qo'shiladi (demo). Hozircha faqat Quick Transfer ishlaydi.");
        }
      });
    });

    // ===== Quick Transfer calculation =====
    const RATES = {
      "UZS_KZT": 0.0400,
      "KZT_UZS": 25.0,
      "UZS_KGS": 0.0075,
      "KGS_UZS": 130.0,
      "KZT_KGS": 0.19,
      "KGS_KZT": 5.2,
    };

    const qtFrom = document.getElementById("qtFrom");
    const qtTo = document.getElementById("qtTo");
    const qtAmount = document.getElementById("qtAmount");
    const qtRecipient = document.getElementById("qtRecipient");
    const qtResult = document.getElementById("qtResult");
    const qtExFee = document.getElementById("qtExFee");
    const qtTrFee = document.getElementById("qtTrFee");
    const qtTotalFee = document.getElementById("qtTotalFee");
    const qtStatus = document.getElementById("qtStatus");
    const qtSendBtn = document.getElementById("qtSendBtn");

    function formatAmount(num, currency) {
      if (!isFinite(num)) return "0 " + currency;
      return num.toLocaleString("en-US", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      }) + " " + currency;
    }

    function recalcQuick() {
      const from = qtFrom.value;
      const to = qtTo.value;
      const rawAmount = parseFloat(qtAmount.value.replace(",", "."));

      if (!rawAmount || rawAmount <= 0) {
        qtResult.textContent = "0 " + to;
        qtExFee.textContent = "0";
        qtTrFee.textContent = "0";
        qtTotalFee.textContent = "0";
        qtStatus.className = "status-text";
        qtStatus.textContent = "Miqdor kiriting â€“ demo hisob-kitob yangilanadi.";
        return;
      }

      let afterExchange = rawAmount;
      let exFee = 0;

      if (from !== to) {
        const key = from + "_" + to;
        const rate = RATES[key];
        if (!rate) {
          qtStatus.className = "status-text err";
          qtStatus.textContent = "Bu yo'nalish demo rejimda hali yo'q. Boshqa valyuta juftligini tanlab ko'ring.";
          qtResult.textContent = "0 " + to;
          qtExFee.textContent = "0";
          qtTrFee.textContent = "0";
          qtTotalFee.textContent = "0";
          return;
        }
        const grossTarget = rawAmount * rate;
        exFee = grossTarget * 0.01; // 1% exchange fee
        afterExchange = grossTarget - exFee;
      }

      const trFee = afterExchange * 0.01; // 1% transfer fee
      const finalAmount = afterExchange - trFee;
      const totalFee = exFee + trFee;

      qtResult.textContent = formatAmount(finalAmount, to);
      qtExFee.textContent = formatAmount(exFee, to);
      qtTrFee.textContent = formatAmount(trFee, to);
      qtTotalFee.textContent = formatAmount(totalFee, to);

      qtStatus.className = "status-text";
      qtStatus.textContent = "Bu taxminiy ko'rsatkichlar. Real kurslar va komissiyalar serverdan olinadi.";
    }

    qtFrom.addEventListener("change", recalcQuick);
    qtTo.addEventListener("change", recalcQuick);
    qtAmount.addEventListener("input", recalcQuick);

    qtSendBtn.addEventListener("click", () => {
      const to = qtTo.value;
      const amountText = qtResult.textContent;
      const recipient = qtRecipient.value.trim();

      if (!qtAmount.value) {
        qtStatus.className = "status-text err";
        qtStatus.textContent = "Miqdor kiriting.";
        return;
      }

      if (!recipient) {
        qtStatus.className = "status-text err";
        qtStatus.textContent = "Qabul qiluvchi ma'lumotini kiriting (demo).";
        return;
      }

      qtStatus.className = "status-text ok";
      qtStatus.textContent =
        "Demo: " +
        recipient +
        " foydalanuvchiga " +
        amountText +
        " yuborish requestâ€™i yaratildi âœ… (hech qanday real to'lov ketmadi).";
    });

    // ===== Profile modal + Telegram WebApp integration =====
    const profileBg = document.getElementById("profileBg");
    const profileOpen = document.getElementById("profileOpen");
    const profileClose = document.getElementById("profileClose");
    const pfName = document.getElementById("pf_name");
    const pfId = document.getElementById("pf_id");
    const pfUsername = document.getElementById("pf_username");

    function openProfile() {
      profileBg.style.display = "flex";
    }

    function closeProfile() {
      profileBg.style.display = "none";
    }

    profileOpen.addEventListener("click", openProfile);
    profileClose.addEventListener("click", closeProfile);
    profileBg.addEventListener("click", (e) => {
      if (e.target === profileBg) closeProfile();
    });

    function initProfileFromTelegram() {
      let name = "-";
      let id = "-";
      let username = "-";

      try {
        if (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe) {
          const u = Telegram.WebApp.initDataUnsafe.user;
          if (u) {
            if (u.first_name || u.last_name) {
              name = [u.first_name, u.last_name].filter(Boolean).join(" ");
            }
            if (u.id) id = String(u.id);
            if (u.username) username = "@" + u.username;
          }
        }
      } catch (e) {
        console.warn("Telegram initDataUnsafe o'qishda xato:", e);
      }

      // Fallback: URL paramlaridan oâ€˜qib koâ€˜ramiz
      try {
        const params = new URLSearchParams(window.location.search);
        if (params.get("tg_name")) name = params.get("tg_name");
        if (params.get("tg_id")) id = params.get("tg_id");
        if (params.get("tg_username")) {
          username = params.get("tg_username").startsWith("@")
            ? params.get("tg_username")
            : "@" + params.get("tg_username");
        }
      } catch (e) {
        console.warn("URL param o'qishda xato:", e);
      }

      pfName.textContent = name;
      pfId.textContent = id;
      pfUsername.textContent = username;
    }

    initProfileFromTelegram();
  </script>
</body>
</html>
