<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <title>AiSend Â· Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #020b04;
      --card: #062511;
      --card-soft: #083318;
      --accent: #a5ff3f;
      --accent-soft: #1e5c1d;
      --accent-text: #031202;
      --danger: #ff4b4b;
      --muted: #7da786;
      --border: #145226;
      --text: #f8fff5;
      --text-soft: #c5e4ce;
      --shadow-soft: 0 24px 40px rgba(0, 0, 0, 0.65);
      --radius-xl: 28px;
      --radius-lg: 20px;
      --radius-pill: 999px;
      --transition-fast: 0.18s ease-out;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      padding: 16px 16px 28px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Display",
        "Roboto", sans-serif;
      background: radial-gradient(120% 140% at 0% 0%, #0f3b1c 0, #020b04 46%, #000 100%);
      color: var(--text);
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .app-title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .app-title-main {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .app-title-sub {
      font-size: 12px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.16em;
    }

    .profile-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px 6px 6px;
      border-radius: var(--radius-pill);
      background: rgba(3, 38, 14, 0.96);
      border: 1px solid rgba(142, 249, 87, 0.5);
      box-shadow: 0 0 0 1px rgba(5, 95, 37, 0.2);
      cursor: pointer;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        background var(--transition-fast);
    }

    .profile-pill:active {
      transform: scale(0.97);
      box-shadow: 0 0 0 1px rgba(182, 255, 136, 0.25);
      background: rgba(7, 57, 22, 0.98);
    }

    .profile-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #eaffd0, #5af27d, #1b7425);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      color: var(--accent-text);
    }

    .profile-labels {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .profile-label-top {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: var(--muted);
    }

    .profile-label-main {
      font-size: 12px;
      font-weight: 600;
      color: var(--accent);
    }

    /* Balance card */

    .balance-card {
      margin-top: 8px;
      padding: 16px 16px 18px;
      border-radius: var(--radius-xl);
      background: radial-gradient(160% 160% at 0% 0%, #43a63a 0, #05250f 45%, #021107 100%);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .balance-row-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 12px;
    }

    .balance-label {
      font-size: 13px;
      color: rgba(237, 255, 237, 0.82);
    }

    .balance-amount {
      margin-top: 4px;
      font-size: 30px;
      font-weight: 800;
      letter-spacing: 0.03em;
      color: #f8ffe7;
    }

    .balance-amount span.ccy {
      font-size: 16px;
      font-weight: 600;
      opacity: 0.9;
      margin-left: 4px;
    }

    .balance-change-pill {
      margin-top: 10px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: rgba(2, 41, 15, 0.85);
      border: 1px solid rgba(107, 255, 139, 0.4);
      font-size: 11px;
      color: var(--text-soft);
    }

    .balance-change-value {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: rgba(81, 208, 104, 0.18);
      color: #9dff58;
      font-weight: 600;
      font-size: 11px;
    }

    .assets-toggle {
      border-radius: var(--radius-pill);
      padding: 6px 12px;
      background: rgba(2, 23, 10, 0.95);
      border: 1px solid rgba(174, 255, 140, 0.4);
      color: var(--accent);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      cursor: pointer;
      margin-top: 2px;
    }

    .assets-toggle span.chevron {
      font-size: 12px;
      transition: transform var(--transition-fast);
    }

    .assets-toggle.expanded span.chevron {
      transform: rotate(180deg);
    }

    .assets-list {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 16px;
      background: rgba(1, 23, 8, 0.78);
      border: 1px solid rgba(95, 180, 109, 0.8);
      display: none;
      backdrop-filter: blur(12px);
    }

    .assets-list.visible {
      display: block;
    }

    .assets-row {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-size: 12px;
      margin-bottom: 4px;
      color: var(--text-soft);
    }

    .assets-row:last-child {
      margin-bottom: 0;
    }

    .assets-row span.value {
      font-weight: 600;
      color: #f4ffe6;
    }

    /* Action tabs */

    .action-tabs {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }

    .action-tab {
      flex: 1;
      border-radius: 18px;
      padding: 10px 6px 8px;
      background: rgba(1, 24, 9, 0.9);
      border: 1px solid rgba(20, 97, 44, 0.7);
      color: var(--text-soft);
      font-size: 11px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .action-tab-icon {
      width: 28px;
      height: 28px;
      border-radius: 12px;
      background: radial-gradient(circle at 0 0, #a9ff59, #1b5a1f);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: var(--accent-text);
    }

    .action-tab.active {
      background: radial-gradient(circle at 0 0, #c7ff73, #14461b);
      border-color: rgba(187, 255, 147, 0.9);
      color: #021304;
      transform: translateY(-1px);
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.6);
    }

    .action-tab.active .action-tab-icon {
      background: #050f04;
      color: var(--accent);
    }

    /* Quick transfer card */

    .section-card {
      margin-top: 16px;
      padding: 18px 16px 18px;
      border-radius: var(--radius-xl);
      background: rgba(2, 18, 8, 0.96);
      border: 1px solid var(--border);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.7);
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .section-sub {
      font-size: 12px;
      color: var(--muted);
      line-height: 1.4;
      margin-bottom: 14px;
    }

    .field-label {
      font-size: 12px;
      color: var(--text-soft);
      margin-bottom: 6px;
    }

    .field {
      margin-bottom: 12px;
    }

    .select,
    .input {
      width: 100%;
      border-radius: 16px;
      padding: 10px 12px;
      border: 1px solid rgba(49, 104, 67, 0.9);
      background: rgba(2, 19, 10, 0.96);
      color: var(--text);
      font-size: 14px;
      outline: none;
      appearance: none;
    }

    .select:focus,
    .input:focus {
      border-color: rgba(179, 255, 156, 0.9);
      box-shadow: 0 0 0 1px rgba(145, 255, 157, 0.4);
    }

    .fee-note {
      font-size: 11px;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.5;
    }

    .summary-card {
      margin-top: 14px;
      padding: 12px 12px 10px;
      border-radius: 18px;
      background: rgba(3, 29, 13, 0.96);
      border: 1px solid rgba(85, 173, 98, 0.9);
      font-size: 12px;
      color: var(--text-soft);
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
    }

    .summary-row strong {
      color: var(--text);
    }

    .summary-main-value {
      font-size: 16px;
      font-weight: 700;
      color: #e6ffcf;
    }

    .summary-main-value span {
      font-size: 13px;
      opacity: 0.8;
      margin-left: 2px;
    }

    .button-primary {
      width: 100%;
      margin-top: 16px;
      border-radius: 18px;
      padding: 12px 16px;
      border: none;
      background: linear-gradient(90deg, #c9ff5f, #82ff47);
      color: #051104;
      font-size: 15px;
      font-weight: 700;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 18px 32px rgba(0, 0, 0, 0.8);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        filter var(--transition-fast);
    }

    .button-primary:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.85);
      filter: brightness(0.97);
    }

    .toast {
      margin-top: 10px;
      font-size: 11px;
      color: #b5ffb9;
    }
  </style>
</head>
<body>
<div class="app">
<header class="app-header">
    <div class="app-title">
      <span class="app-title-sub">AISEND Â· DEMO</span>
      <span class="app-title-main">Super balance</span>
    </div>

    <div class="profile-pill" id="openProfileBtn">
      <div class="profile-avatar" id="profileAvatar">
        TG
      </div>
      <div class="profile-labels">
        <span class="profile-label-top">Profil</span>
        <span class="profile-label-main" id="profileShort">@demo</span>
      </div>
    </div>
  </header>

  <section class="balance-card">
    <div class="balance-row-top">
      <div>
        <div class="balance-label">Umumiy balans</div>
        <div class="balance-amount" id="totalBalance">
          12 450.00<span class="ccy">USZ</span>
        </div>
        <div class="balance-change-pill">
          <span class="balance-change-value">+3.4%</span>
          <span>Oxirgi hafta (demo)</span>
        </div>
      </div>

      <button class="assets-toggle" id="assetsToggle">
        <span id="assetsToggleText">Barcha aktivlar</span>
        <span class="chevron">â–¼</span>
      </button>
    </div>

    <div class="assets-list" id="assetsList">
      <div class="assets-row">
        <span>Fiat balans</span>
        <span class="value">9 200.00 USZ</span>
      </div>
      <div class="assets-row">
        <span>Crypto (demo)</span>
        <span class="value">2 150.45 USZ</span>
      </div>
      <div class="assets-row">
        <span>Stocks (demo)</span>
        <span class="value">1 099.55 USZ</span>
      </div>
    </div>

    <div class="action-tabs" id="actionTabs">
      <div class="action-tab active" data-mode="send">
        <div class="action-tab-icon">â†‘</div>
        <div>Send</div>
      </div>
      <div class="action-tab" data-mode="exchange">
        <div class="action-tab-icon">â‡„</div>
        <div>Exchange</div>
      </div>
      <div class="action-tab" data-mode="crypto">
        <div class="action-tab-icon">â‚¿</div>
        <div>Crypto</div>
      </div>
      <div class="action-tab" data-mode="stocks">
        <div class="action-tab-icon">ðŸ“ˆ</div>
        <div>Stocks</div>
      </div>
    </div>
  </section>

  <section class="section-card" id="quickTransferCard">
    <div class="section-title">Quick Transfer</div>
    <div class="section-sub">
      UZS â†’ KZT / KGS kartaga tezkor oâ€˜tkazmalar (demo).
      Komissiya tarkibini oldindan koâ€˜rib turasiz.
    </div>

    <div class="field">
      <div class="field-label">From valyuta</div>
      <select class="select" id="fromCurrency">
        <option value="UZS">UZS (Uzbekistan)</option>
        <option value="KZT">KZT (Kazakhstan)</option>
        <option value="KGS">KGS (Kyrgyzstan)</option>
      </select>
    </div>

    <div class="field">
      <div class="field-label">To valyuta</div>
      <select class="select" id="toCurrency">
        <option value="KZT">KZT (Kazakhstan)</option>
        <option value="UZS">UZS (Uzbekistan)</option>
        <option value="KGS">KGS (Kyrgyzstan)</option>
      </select>
    </div>

    <div class="field">
      <div class="field-label">Miqdor</div>
      <input
        type="number"
        min="0"
        class="input"
        id="amountInput"
        placeholder="Miqdor kiriting"
      />
    </div>

    <div class="field">
      <div class="field-label">Qabul qiluvchi (demo)</div>
      <input
        type="text"
        class="input"
        id="receiverInput"
        placeholder="@username yoki karta raqam (demo)"
      />
    </div>

    <div class="fee-note">
      Komissiyalar: <strong>1% exchange + 1% transfer</strong> (demo).
      Real ilovada bu raqamlar litsenziyaga qarab oâ€˜zgaradi.
    </div>

    <div class="summary-card">
      <div class="summary-row">
        <span>Qabul qiluvchi oladi (taxminan)</span>
        <span class="summary-main-value" id="summaryNet">
          0.00 <span id="summaryNetCcy">KZT</span>
        </span>
      </div>
      <div class="summary-row">
        <span>Exchange fee (1%)</span>
        <span id="summaryExFee">0.00 KZT</span>
      </div>
      <div class="summary-row">
        <span>Transfer fee (1%)</span>
        <span id="summaryTrFee">0.00 KZT</span>
      </div>
      <div class="summary-row">
        <strong>Umumiy komissiya</strong>
        <strong id="summaryTotalFee">0.00 KZT</strong>
      </div>
    </div>

    <button class="button-primary" id="confirmButton">
      Yuborishni tasdiqlash (demo)
    </button>
    <div class="toast" id="demoToast"></div>
  </section>
<!-- Profil bottom sheet -->
  <div
    id="profileSheet"
    style="
      position: fixed;
      left: 0;
      right: 0;
      bottom: -420px;
      max-width: 480px;
      margin: 0 auto;
      padding: 18px 18px 24px;
      background: radial-gradient(130% 180% at 0% 0%, #124925 0, #020b06 60%, #000 100%);
      border-radius: 24px 24px 0 0;
      border-top: 1px solid rgba(165, 255, 147, 0.4);
      border-left: 1px solid rgba(51, 132, 73, 0.6);
      border-right: 1px solid rgba(51, 132, 73, 0.6);
      color: #f4ffe9;
      box-shadow: 0 -18px 40px rgba(0, 0, 0, 0.9);
      transition: bottom 0.22s ease-out;
      z-index: 40;
    "
  >
    <div
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      "
    >
      <div style="font-size: 17px; font-weight: 700">Telegram profil</div>
      <button
        id="closeProfileBtn"
        style="
          width: 28px;
          height: 28px;
          border-radius: 50%;
          border: none;
          background: rgba(8, 36, 18, 0.9);
          color: #f4ffe6;
          font-size: 18px;
        "
      >
        Ã—
      </button>
    </div>

    <div style="font-size: 13px; color: #c8e6d0; margin-bottom: 12px">
      Maâ€™lumotlar faqat demo uchun koâ€˜rsatilmoqda. Real ilovada KYC va
      xavfsizlik siyosatiga mos ishlaydi.
    </div>

    <div style="border-top: 1px dashed rgba(129, 194, 142, 0.65); margin: 8px 0 10px"></div>

    <div style="font-size: 13px; margin-bottom: 8px">
      <strong>Ism:</strong> <span id="pfName">-</span>
    </div>
    <div style="font-size: 13px; margin-bottom: 8px">
      <strong>ID:</strong> <span id="pfId">-</span>
    </div>
    <div style="font-size: 13px; margin-bottom: 16px">
      <strong>Username:</strong> <span id="pfUsername">-</span>
    </div>

    <button
      style="
        width: 100%;
        border-radius: 18px;
        padding: 10px 16px;
        border: 1px solid rgba(145, 255, 152, 0.7);
        background: rgba(3, 33, 15, 0.95);
        color: #d6ffd3;
        font-weight: 600;
        margin-bottom: 10px;
      "
    >
      Sozlamalar (tez orada)
    </button>

    <button
      style="
        width: 100%;
        border-radius: 18px;
        padding: 11px 16px;
        border: none;
        background: linear-gradient(90deg, #ff5b5b, #ff3131);
        color: #fff4f4;
        font-weight: 700;
      "
    >
      Chiqish (tez orada)
    </button>
  </div>
</div> <!-- /.app -->

<script>
  // --- Demo kurslar (faqat front uchun) ---
  const DEMO_RATES = {
    "UZS_KZT": 0.0436081101,
    "KZT_UZS": 1 / 0.0436081101,
    "UZS_KGS": 0.0067,
    "KGS_UZS": 1 / 0.0067,
    "KZT_KGS": 0.153,
    "KGS_KZT": 1 / 0.153
  };

  function formatAmount(num, ccy) {
    if (!isFinite(num)) num = 0;
    return (
      num.toLocaleString("ru-RU", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }) +
      " " +
      ccy
    );
  }

  // Quick transfer recalculation
  function recalcSummary() {
    const from = document.getElementById("fromCurrency").value;
    const to = document.getElementById("toCurrency").value;
    const raw = parseFloat(document.getElementById("amountInput").value || "0");
    const amount = isFinite(raw) ? raw : 0;

    const pairKey = from + "_" + to;
    const baseRate = DEMO_RATES[pairKey] || 0;
    const converted = amount * baseRate;

    const exFee = converted * 0.01;
    const trFee = converted * 0.01;
    const totalFee = exFee + trFee;
    const net = converted - totalFee;

    document.getElementById("summaryNet").innerHTML =
      formatAmount(net, to) + "";
    document.getElementById("summaryNetCcy").textContent = to;
    document.getElementById("summaryExFee").textContent = formatAmount(exFee, to);
    document.getElementById("summaryTrFee").textContent = formatAmount(trFee, to);
    document.getElementById("summaryTotalFee").textContent = formatAmount(
      totalFee,
      to
    );
  }

  // Confirm button (demo only)
  function handleConfirm() {
    const amount = parseFloat(document.getElementById("amountInput").value || "0");
    const receiver = document.getElementById("receiverInput").value.trim();
    const to = document.getElementById("toCurrency").value;
    const toast = document.getElementById("demoToast");

    if (!amount || !receiver) {
      toast.style.color = "#ffb3b3";
      toast.textContent = "Miqdor va qabul qiluvchini kiriting (demo).";
      return;
    }

    toast.style.color = "#b5ffb9";
    toast.textContent =
      "Demo: " +
      receiver +
      " foydalanuvchiga taxminan " +
      document.getElementById("summaryNet").textContent +
      " yuborildi deb tasavvur qilamiz âœ…";
  }

  // Tabs
  function setupTabs() {
    const tabs = document.querySelectorAll(".action-tab");
    tabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        tabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        const mode = tab.dataset.mode;

        const card = document.getElementById("quickTransferCard");
        if (mode === "send") {
          card.querySelector(".section-title").textContent = "Quick Transfer";
        } else if (mode === "exchange") {
          card.querySelector(".section-title").textContent = "Exchange (demo)";
        } else if (mode === "crypto") {
          card.querySelector(".section-title").textContent = "Crypto (demo)";
        } else if (mode === "stocks") {
          card.querySelector(".section-title").textContent = "Stocks (demo)";
        }
      });
    });
  }

  // Assets toggle
  function setupAssetsToggle() {
    const toggle = document.getElementById("assetsToggle");
    const list = document.getElementById("assetsList");
    const label = document.getElementById("assetsToggleText");

    toggle.addEventListener("click", () => {
      const expanded = list.classList.toggle("visible");
      toggle.classList.toggle("expanded", expanded);
      label.textContent = expanded ? "Yopish" : "Barcha aktivlar";
    });
  }

  // Profile sheet open/close
  function setupProfileSheet() {
    const sheet = document.getElementById("profileSheet");
    const openBtn = document.getElementById("openProfileBtn");
    const closeBtn = document.getElementById("closeProfileBtn");

    function open() {
      sheet.style.bottom = "0";
    }
    function close() {
      sheet.style.bottom = "-420px";
    }

    openBtn.addEventListener("click", open);
    closeBtn.addEventListener("click", close);
  }

  // Telegram profile
  function loadTelegramProfile() {
    let name = null;
    let id = null;
    let username = null;

    // 1) initDataUnsafe
    if (window.Telegram && Telegram.WebApp && Telegram.WebApp.initDataUnsafe) {
      try {
        const u = Telegram.WebApp.initDataUnsafe.user;
        if (u) {
          if (u.first_name || u.last_name) {
            name = [u.first_name, u.last_name].filter(Boolean).join(" ");
          }
          if (u.id) {
            id = String(u.id);
          }
          if (u.username) {
            username = u.username;
          }
        }
      } catch (e) {
        console.warn("Telegram initDataUnsafe oâ€˜qishda xato:", e);
      }
    }

    // 2) URL paramlari orqali fallback
    const params = new URLSearchParams(window.location.search);
    if (!name && params.get("tg_name")) {
      name = params.get("tg_name");
    }
    if (!id && params.get("tg_id")) {
      id = params.get("tg_id");
    }
    if (!username && params.get("tg_username")) {
      username = params.get("tg_username");
    }

    document.getElementById("pfName").textContent = name || "-";
    document.getElementById("pfId").textContent = id || "-";
    document.getElementById("pfUsername").textContent = username
      ? "@" + username
      : "-";

    // Header qisqa koâ€˜rinish
    const short = document.getElementById("profileShort");
    const avatar = document.getElementById("profileAvatar");
    if (name) {
      short.textContent = name.split(" ")[0];
    } else if (username) {
      short.textContent = "@" + username;
    }
    if (name) {
      const initials = name
        .split(" ")
        .map((s) => s.charAt(0))
        .join("")
        .slice(0, 2)
        .toUpperCase();
      avatar.textContent = initials;
    } else if (username) {
      avatar.textContent = username.charAt(0).toUpperCase();
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    // Listeners
    ["fromCurrency", "toCurrency", "amountInput"].forEach((id) => {
      const el = document.getElementById(id);
      el.addEventListener("input", recalcSummary);
      el.addEventListener("change", recalcSummary);
    });

    document
      .getElementById("confirmButton")
      .addEventListener("click", handleConfirm);

    setupTabs();
    setupAssetsToggle();
    setupProfileSheet();
    loadTelegramProfile();
    recalcSummary();
  });
</script>
</body>
</html>
